# Lookup a Malware Hash from the Command Line

Looking up hashes of potential malware is a common task as a security professional. I recently learned a new way to do this via the command line.

Team Cymru offers a unique service that allows you to query their Malware Hash Registry. You can query using a variety of services - Whois, DNS, HTTP, and HTTPS.

Here is the help menu for the Whois service:

```bash
$ whois -h hash.cymru.com help
[COMMANDS]
Whois   Netcat          Action
        begin           enable bulk input mode          (netcat only)
        end             exit the whois/netcat client    (netcat only)
-h      help            this help message

When using netcat, be sure to only use GNU's version:

        <http://netcat.sourceforge.net>

[SYNTAX]
Each line may have malware hash syntax that follows any of these standards:

        MD5
	SHA1

[EXAMPLES]
Whois query:

	$ whois hash.cymru.com 43 e1112134b6dcc8bed54e0e34d8ac272795e73d74

Bulk input requires the use of GNU 'netcat'.  The syntax for a bulk
input session might look as follows:

        $ netcat hash.cymru.com 43 < ./list.txt

        Where list.txt must follow the following syntax:
        begin
        e1112134b6dcc8bed54e0e34d8ac272795e73d74
        ...
        end

[ABOUT]
Please refer to the following URL for additional questions:

        <http://www-temp.team-cymru.org/Services/MHR/>

```

Now for an example:

```bash
whois -h hash.cymru.com a8ef5ccebd2e3babdd243a2861673c26
a8ef5ccebd2e3babdd243a2861673c26 1445026908 79
```
It was in the DB and has a detection percentage of 79.

If the hash is not in the database the output will look like this:

```bash
$ whois -h hash.cymru.com f6f1564370d0b0b758894fdb6608ceab
f6f1564370d0b0b758894fdb6608ceab 1456891875 NO_DATA
```
Bulk lookups should be done via netcat or HTTP/HTTPS.

Additional information can be found here: (http://www.team-cymru.org/MHR.html)

